# 自有兑换取消步长

![image-20250113184649598](../../../picture/image-20250113184649598.png)



币对兑换步长限制放开: 

- 超过步长的部分，先截取尾数，计算这部分占整单的比例，如果已超过设置的费率，则不接此单，交给其他交易所；
- 如果未超过设置的费率，则计算剩余应收的收益，正常接单

```
- 理论上最大收费的数量 = 兑出数量 * 0.045(收费策略)
- 如果 理论上最大收费的数量 大于 被截断的兑出数量小数部分 -> 说明被截断的部分可以全部抹除, 包含在收费比例中
- 如果 理论上最大收费的数量 小于 被截断的兑出数量小数部分 -> 说明被截断的部分价值占比太高了, 截断用户亏损太多, 此时不接单
	
(截断后的兑出数量 + 被截断的兑出数量小数部分) * y收费策略 = (截断后的兑出数量 * x剩余收费策略) + 被截断的兑出数量小数部分
求: (A + B) * y = A * x + B
解: x = y - (B / A) * (1 - y)
	- x剩余收费策略 = y收费策略 - (被截断的兑出数量小数部分 /  截断后的兑出数量) * (1 - y收费策略)
```



# 最大可抹除的小数

**最大可抹除的小数 = 兑出数量 * 0.072(收费策略)**



> 例1(成功): ETH_BTC

![image-20250115184122691](../../../picture/image-20250115184122691.png)

- ETH(兑出数量) = 0.037222
- ETH 步长 = 0.001
- ETH 抹除小数部分 = 0.000222

最大可抹除的小数 = 0.037222 * 0.0072(收费策略) = 0.00026800
- 0.00026800 > 0.000222(ETH 抹除小数部分)
- 最大可抹除小数 **大于** 当前兑出小数
- 可抹除, 接单



> 例2(失败): ETH_BTC

![image-20250115184632500](../../../picture/image-20250115184632500.png)

- ETH(兑出数量) = 0.037333
- ETH 步长 = 0.001
- ETH 抹除小数部分 = 0.000333

最大可抹除的小数 = 0.037333 * 0.0072(收费策略) = 0.00026879760

- 0.00026879760 < 0.000333(ETH 抹除小数部分)
- 最大可抹除小数 **小于** 当前兑出小数
- 不可抹除, 不接单



