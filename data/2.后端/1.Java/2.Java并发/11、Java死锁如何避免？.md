# Java死锁如何避免？ 

**多个线程抢占资源出现互相等待导致死锁**

> 造成死锁的⼏个原因： 

1. ⼀个资源每次只能被⼀个线程使⽤ 
2. ⼀个线程在阻塞等待某个资源时，不释放已占有资源 

3. ⼀个线程已经获得的资源，在未使⽤完之前，不能被强⾏剥夺 

4. 若⼲线程形成头尾相接的循环等待资源关系 

- 这是造成死锁必须要达到的4个条件，如果要避免死锁，只需要不满⾜其中某⼀个条件即可。
- ⽽其中前3 个条件是作为锁要符合的条件
- 所以要避免死锁就需要`打破第4个条件`,不出现循环等待锁的关系。 

**这样记忆没有意义,所以换一种记忆的方式,锁的特点**

1. 加锁的资源只能同时被一个线程使用 -> `多个线程不能使用同一个资源`
2. 加锁的资源所在线程就算阻塞,也不会释放锁 -> `不释放已占有资源 `
3. 加锁的资源所在线程不能强行释放锁 -> `资源未使⽤完之前，是不能被强⾏剥夺的 `
4. 多个锁`嵌套使用`,容易造成`循环等待资源`,产生死锁

> 在开发过程中： 

1. 要注意加锁顺序，保证每个线程按同样的顺序进⾏加锁 
   - 加锁的顺利要一致,不要出现`锁1嵌套锁2,锁2又嵌套锁1`的情况

2. 要注意加锁时限，可以针对所设置⼀个超时时间 
   - Lock锁里面有一个`tryLock`的方法,可以设置一个超时时间,可以利用这个方法做一个`获取锁时间上的限制`

